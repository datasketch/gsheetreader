!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).GSheetReader=t()}(this,(function(){"use strict";return class{getTable(e){const t=[],s=Math.max(...e.map((e=>+e.gs$cell.col))),o=Math.max(...e.map((e=>+e.gs$cell.row)));for(let e=0;e<o;e++){const e=Array(s);t.push(e)}for(const s of e){const e=+s.gs$cell.row,o=+s.gs$cell.col;t[e-1][o-1]=+s.gs$cell.numericValue||s.gs$cell.$t}for(let e=0;e<o;e++)for(let s=0;s<t[e].length;s++)t[e][s]||(t[e][s]="");return{table:t,size:{cols:s,rows:o}}}async getJSON(e,t=1){const s=`https://spreadsheets.google.com/feeds/cells/${e}/${t}/public/values?alt=json`;try{const e=await async function(e){try{const t=await fetch(e);return(await t.json()).feed.entry}catch(e){throw new Error(e)}}(s),{table:t,size:o}=this.getTable(e),l=t.shift();return{data:t.map((e=>e.reduce(((e,t,s)=>(e[l[s]]=t,e)),{}))),headers:l,size:o}}catch(e){throw new Error(e)}}}}));
